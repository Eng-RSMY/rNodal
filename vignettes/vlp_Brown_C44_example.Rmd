---
title: "VLP Brown C44 example"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{VLP Brown C44 example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


## Example C44 by Hagendorn-Brown
This notebook runs the modified Hagedorn-Brown correlation calculated according
to Brown's book and procedure in Appendix C. Although the question is not really
pointed at finding the bottomhole flowing pressure given the surface conditions
and the wellhead pressure but rather calculating the length of the tubing if BHP
is known, the calculations here demonstrate that both can be calculated or
verified using this algorithm.

The pressures at both ends of the tubing: P1 is 500 psia and P2 1000 psia.

```{r rows.print=30}
library(rNodal)

# Example from C.44 in Brown
# P2 (pressure at end point is given in the original example). 
# The original question is: what is the length of the tubing.
#
# In our case we aproximately know the length (from the book), so we will try to
# match P2 (known)
#
# Differences with Example C.13:
# GLR, watercut, oil viscosity and API are different in C.44
#
# The final results are very close to those of Brown.



# source("VLP.R")

# rhdf5::H5close()
input_example <- setWellInput(field.name = "HAGBR.MOD",
                                 well.name = "Brown_C44", 
                                 depth.wh = 0, depth.bh = 3590, 
                                 diam.in = 1.995, 
                                 GLR = 1000, liq.rt = 600, wcut = 0.0, 
                                 thp = 500, tht = 120, bht = 150, 
                                 API = 42, oil.visc = 1.0, 
                                 gas.sg = 0.65, wat.sg = 1.07, if.tens = 30
                                 )

well_model <- setVLPmodel(vlp.model = "hagbr.mod", segments = 29, tol = 0.00001)


runVLP(well.input = input_example, well_model)
```







