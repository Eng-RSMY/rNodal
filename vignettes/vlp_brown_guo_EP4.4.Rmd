---
title: "VLP Brown. Guo Example Problem 4.4"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{VLP Brown. Guo Example Problem 4.4}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


## Calculate VLP using Hagedorn-Brown (no heat transfer)

> NOTE. There is a problem with the GLR. Program crashes at GLR =< 362.6. Why?

    Error in if (eps >= tol) p1 = p.calc : missing value where TRUE/FALSE needed
    

```{r rows.print=30}
library(rNodal)

# Example Problem from Guo book

input.example.P44 <- setWellInput(field.name = "HAGBR.MOD",
                                    well.name = "Guo_P44", 
                                    depth.wh = 0, depth.bh = 9700, diam.in = 1.995, 
                                    GLR = 360.7, liq.rt = 758, wcut = 0.1, 
                                    thp = 100, tht = 80, bht = 180, 
                                    API = 40, gas.sg = 0.70, wat.sg = 1.05, if.tens = 30)


well.model <- setVLPmodel(vlp.model = "hagbr.mod", segments = 29, tol = 0.000001)

df <- runVLP(well.input = input.example.P44, well.model)
df
```
